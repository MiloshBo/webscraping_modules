# https://automatetheboringstuff.com/chapter13/
# https://python-docx.readthedocs.io/en/latest/

import docx

doc = docx.Document('demo.docx')
print(len(doc.paragraphs))
print(doc.paragraphs[0].text)
print(doc.paragraphs[1].text)
print(len(doc.paragraphs[1].runs))
print(doc.paragraphs[1].runs[0].text)
print(doc.paragraphs[1].runs[1].text)
print(doc.paragraphs[1].runs[2].text)

def getText(filename):
	doc = docx.Document(filename)
	fullText = []
	for para in doc.paragraphs:
		fullText.append(para.text)
	return '\n'.join(fullText)
newdoc = getText('demo.docx')
print(newdoc)
# if we import getText function as a module ( readDocx.py )
print(readDocx.getText('demo.docx'))

doc = docx.Document('demo.docx')
print(doc.paragraphs[0].text)
print(doc.paragraphs[0].style)
doc.paragraphs[0].style = 'Normal'
print(doc.paragraphs[1].text)
print((doc.paragraphs[1].runs[0].text, doc.paragraphs[1].runs[1].text, doc.
paragraphs[1].runs[2].text, doc.paragraphs[1].runs[3].text))
doc.paragraphs[1].runs[0].style = 'QuoteChar'
doc.paragraphs[1].runs[1].underline = True
doc.paragraphs[1].runs[3].underline = True
doc.save('restyled.docx')

doc = docx.Document()
doc.add_paragraph('Hello World!', 'Title')
paraObj1 = doc.add_paragraph('This is a second paragraph.')
paraObj2 = doc.add_paragraph('This is a yet another paragraph.')
paraObj1.add_run(' This text is being added to the second paragraph.')
doc.add_heading('Header 0', 0)
doc.add_heading('Header 1', 1)
doc.add_heading('Header 2', 2)
doc.add_heading('Header 3', 3)
doc.add_heading('Header 4', 4)
doc.add_paragraph('This is on the first page!')
doc.paragraphs[0].runs[0].add_break(docx.enum.text.WD_BREAK.LINE)
doc.add_paragraph('This is on the second page!')
doc.add_picture('zophie.png', width=docx.shared.Inches(1), height=docx.shared.Cm(4))
doc.save('helloworld.docx')


from docx import Document

document = Document()

paragraph = document.add_paragraph('Lorem ipsum dolor sit amet.')

prior_paragraph = paragraph.insert_paragraph_before('Lorem ipsum')

document.add_heading('The REAL meaning of the universe')
document.add_heading('The role of dolphins', level=2)

document.add_page_break()

table = document.add_table(rows=2, cols=2)

cell = table.cell(0, 1)
cell.text = 'parrot, possibly dead'

row = table.rows[1]
row.cells[0].text = 'Foo bar to you.'
row.cells[1].text = 'And a hearty foo bar to you too sir!'
for row in table.rows:
	for cell in row.cells:
		print(cell.text)
row_count = len(table.rows)
col_count = len(table.columns)
row = table.add_row()

# get table data -------------
items = (
    (7, '1024', 'Plush kittens'),
    (3, '2042', 'Furbees'),
    (1, '1288', 'French Poodle Collars, Deluxe'),
)
# add table ------------------
table = document.add_table(1, 3)
# populate header row---------
heading_cells = table.rows[0].cells
heading_cells[0].text = 'Qty'
heading_cells[1].text = 'SKU'
heading_cells[2].text = 'Description'
# add a data row for each item
for item in items:
	cells = table.add_row().cells
	cells[0].text = str(item.qty)
	cells[1].text = item.sku
	cells[2].text = item.desc
table.style = 'LightShading-Accent1'

document.add_picture('image-filename.png')


from docx.shared import Inches
document.add_picture('image-filename.png', width=Inches(1.0))

document.add_paragraph('Lorem ipsum dolor sit amet.', style='ListBullet') # or
paragraph = document.add_paragraph('Lorem ipsum dolor sit amet.')
paragraph.style = 'List Bullet'

paragraph = document.add_paragraph('Lorem ipsum')
paragraph.add_run('dolor')
run.bold = True
paragraph.add_run(' sit amet.')

paragraph.add_run('dolor').bold = True # is equivalent to:
run = paragraph.add_run('dolor')
run.bold = True 

paragraph = document.add_paragraph()
paragraph.add_run('Lorem ipsum ')
paragraph.add_run('dolor').bold = True
paragraph.add_run(' sit amet.')

paragraph = document.add_paragraph('Normal text, ')
paragraph.add_run('text with emphasis.', 'Emphasis')

paragraph = document.add_paragraph('Normal text, ')
run = paragraph.add_run('text with emphasis.')
run.style = 'Emphasis'


from docx import Document
# opening a document
document = Document()
document.save('test.docx')
# really opening a document
document = Document('existing-doc-file.docx')
document.save('new-file-name.docx')
# opening a file-like document
f = open('foobar.doxc', 'rb')
document = Document(f)
f.close() # or
with open('foobar.docx', 'rb') as f:
	source_stream = StringIO(f.read())
document = Document(source_stream)
source_stream.close()
target_stream = StringIO()
document.save(target_stream)

from docx.enum.text import WD_ALIGN_PARAGRAPH
document = Document()
paragraph = document.add_paragraph()
paragraph_format = paragraph.paragraph_format
paragraph_format.alignment
None # indicating alignment is inherited from the style hierarchy
paragraph_format.alignment = WD_ALIGN_PARAGRAPH.CENTER
paragraph_format.alignment
CENTER (1)

from docx.shared import Inches
paragraph = document.add_paragraph()
paragraph_format = paragraph.paragraph_format
paragraph_format.left_indent
None # Indicating indentation is inherited from the style hierarchy
paragraph_format.left_indent = Inches(0.5)
paragraph_format.left_indent
paragraph_format.left_indent.inches

from docx.shared import Pt
paragraph_format.right_indent
None
paragraph_format.right_indent = Pt(24)
paragraph_format.right_indent.pt

paragraph_format.first_line_indent
None
paragraph_format.first_line_indent = Inches(-0.25)
paragraph_format.first_line_indent
paragraph_format.first_line_indent.inches
